<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FlashDoc Test Runner</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #333;
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      text-align: center;
    }

    h1 {
      font-size: 32px;
      margin-bottom: 10px;
      color: #667eea;
    }

    .subtitle {
      color: #666;
      font-size: 16px;
    }

    .test-controls {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .test-results {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .results-summary {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .summary-card {
      flex: 1;
      min-width: 200px;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
    }

    .summary-card.total {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .summary-card.passed {
      background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);
      color: white;
    }

    .summary-card.failed {
      background: linear-gradient(135deg, #e53935 0%, #e35d5b 100%);
      color: white;
    }

    .summary-number {
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .summary-label {
      font-size: 14px;
      opacity: 0.9;
    }

    #test-output {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 20px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.6;
      max-height: 600px;
      overflow-y: auto;
      white-space: pre-wrap;
    }

    .test-suite {
      margin-bottom: 10px;
      padding: 10px;
      background: rgba(102, 126, 234, 0.05);
      border-left: 3px solid #667eea;
      border-radius: 4px;
    }

    .test-passed {
      color: #56ab2f;
    }

    .test-failed {
      color: #e53935;
    }

    @media (max-width: 768px) {
      .test-controls {
        flex-direction: column;
      }

      button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>‚ö° FlashDoc Test Runner</h1>
      <p class="subtitle">Automated tests for format detection, blob creation, and settings integration</p>
    </div>

    <div class="test-controls">
      <button onclick="runAllTests()">Run All Tests</button>
      <button onclick="runFormatDetectionTests()">Format Detection</button>
      <button onclick="runBlobCreationTests()">Blob Creation</button>
      <button onclick="runSettingsTests()">Settings Integration</button>
      <button onclick="clearOutput()">Clear Output</button>
    </div>

    <div class="test-results">
      <div class="results-summary">
        <div class="summary-card total">
          <div class="summary-number" id="total-tests">0</div>
          <div class="summary-label">Total Tests</div>
        </div>
        <div class="summary-card passed">
          <div class="summary-number" id="passed-tests">0</div>
          <div class="summary-label">Passed</div>
        </div>
        <div class="summary-card failed">
          <div class="summary-number" id="failed-tests">0</div>
          <div class="summary-label">Failed</div>
        </div>
      </div>
      <div id="test-output">Click a button above to run tests...</div>
    </div>
  </div>

  <script>
    let totalTests = 0;
    let passedTests = 0;
    let failedTests = 0;

    function clearOutput() {
      document.getElementById('test-output').innerHTML = 'Click a button above to run tests...';
      resetCounters();
    }

    function resetCounters() {
      totalTests = 0;
      passedTests = 0;
      failedTests = 0;
      updateSummary();
    }

    function updateSummary() {
      document.getElementById('total-tests').textContent = totalTests;
      document.getElementById('passed-tests').textContent = passedTests;
      document.getElementById('failed-tests').textContent = failedTests;
    }

    function runAllTests() {
      clearOutput();
      const output = document.getElementById('test-output');
      output.innerHTML = '<div class="test-suite">üöÄ Running all tests...\n\n</div>';

      setTimeout(() => {
        runFormatDetectionTests();
        setTimeout(() => {
          runBlobCreationTests();
          setTimeout(() => {
            runSettingsTests();
            setTimeout(() => {
              output.innerHTML += `\n<div class="test-suite">‚ú® All tests completed!\n\nTotal: ${totalTests} | Passed: ${passedTests} | Failed: ${failedTests}</div>`;
            }, 100);
          }, 100);
        }, 100);
      }, 100);
    }

    function runFormatDetectionTests() {
      const output = document.getElementById('test-output');
      if (output.innerHTML === 'Click a button above to run tests...') {
        output.innerHTML = '';
        resetCounters();
      }

      output.innerHTML += '<div class="test-suite">üì¶ Running Format Detection Tests...\n\n</div>';

      // Intercept console output
      const originalLog = console.log;
      const originalError = console.error;
      let testOutput = '';

      console.log = function(...args) {
        const line = args.join(' ');
        testOutput += line + '\n';

        if (line.includes('‚úÖ')) {
          passedTests++;
          totalTests++;
        }
      };

      console.error = function(...args) {
        const line = args.join(' ');
        testOutput += line + '\n';

        if (line.includes('‚ùå')) {
          failedTests++;
          totalTests++;
        }
      };

      // Load and run the test
      const script = document.createElement('script');
      script.src = 'format-detection.test.js';
      script.onload = () => {
        output.innerHTML += testOutput.replace(/‚úÖ/g, '<span class="test-passed">‚úÖ</span>').replace(/‚ùå/g, '<span class="test-failed">‚ùå</span>');
        console.log = originalLog;
        console.error = originalError;
        updateSummary();
      };
      document.body.appendChild(script);
    }

    function runBlobCreationTests() {
      const output = document.getElementById('test-output');
      if (output.innerHTML === 'Click a button above to run tests...') {
        output.innerHTML = '';
        resetCounters();
      }

      output.innerHTML += '<div class="test-suite">üì¶ Running Blob Creation Tests...\n\n</div>';

      const originalLog = console.log;
      const originalError = console.error;
      let testOutput = '';

      console.log = function(...args) {
        const line = args.join(' ');
        testOutput += line + '\n';

        if (line.includes('‚úÖ')) {
          passedTests++;
          totalTests++;
        }
      };

      console.error = function(...args) {
        const line = args.join(' ');
        testOutput += line + '\n';

        if (line.includes('‚ùå')) {
          failedTests++;
          totalTests++;
        }
      };

      const script = document.createElement('script');
      script.src = 'blob-creation.test.js';
      script.onload = () => {
        output.innerHTML += testOutput.replace(/‚úÖ/g, '<span class="test-passed">‚úÖ</span>').replace(/‚ùå/g, '<span class="test-failed">‚ùå</span>');
        console.log = originalLog;
        console.error = originalError;
        updateSummary();
      };
      document.body.appendChild(script);
    }

    function runSettingsTests() {
      const output = document.getElementById('test-output');
      if (output.innerHTML === 'Click a button above to run tests...') {
        output.innerHTML = '';
        resetCounters();
      }

      output.innerHTML += '<div class="test-suite">üì¶ Running Settings Integration Tests...\n\n</div>';

      const originalLog = console.log;
      const originalError = console.error;
      let testOutput = '';

      console.log = function(...args) {
        const line = args.join(' ');
        testOutput += line + '\n';

        if (line.includes('‚úÖ')) {
          passedTests++;
          totalTests++;
        }
      };

      console.error = function(...args) {
        const line = args.join(' ');
        testOutput += line + '\n';

        if (line.includes('‚ùå')) {
          failedTests++;
          totalTests++;
        }
      };

      const script = document.createElement('script');
      script.src = 'settings-integration.test.js';
      script.onload = () => {
        output.innerHTML += testOutput.replace(/‚úÖ/g, '<span class="test-passed">‚úÖ</span>').replace(/‚ùå/g, '<span class="test-failed">‚ùå</span>');
        console.log = originalLog;
        console.error = originalError;
        updateSummary();
      };
      document.body.appendChild(script);
    }
  </script>
</body>
</html>
